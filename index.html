<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#080808">
    
    <title>DISTRI EL URU | Premium System</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap');
        
        :root {
            --bg-main: #080808;
            --bg-card: linear-gradient(145deg, #161616, #0c0c0c);
            --text-main: #e0e0e0;
            --text-muted: #888;
            --border-color: rgba(255, 255, 255, 0.05);
            --input-bg: #151515;
            --footer-bg: #050505;
        }

        body.light-mode {
            --bg-main: #f3f4f6;
            --bg-card: linear-gradient(145deg, #ffffff, #f9fafb);
            --text-main: #111827;
            --text-muted: #4b5563;
            --border-color: rgba(0, 0, 0, 0.1);
            --input-bg: #ffffff;
            --footer-bg: #e5e7eb;
        }

        body { background-color: var(--bg-main); color: var(--text-main); font-family: 'Inter', sans-serif; transition: all 0.4s ease; overflow-x: hidden; }
        
        .product-card { 
            background: var(--bg-card); 
            border: 1px solid var(--border-color); 
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); 
        }
        .product-card:hover { transform: translateY(-8px); border-color: #ea580c; box-shadow: 0 20px 40px rgba(0,0,0,0.4); }

        .animate-marquee { display: flex; width: max-content; animation: marquee 25s linear infinite; }
        @keyframes marquee { 0% { transform: translateX(0); } 100% { transform: translateX(-50%); } }

        .fila-check { opacity: 0.2; filter: grayscale(1); text-decoration: line-through; }
        .no-scrollbar::-webkit-scrollbar { display: none; }

        @media print {
            .no-print { display: none !important; }
            #modal-logistica { position: absolute; inset: 0; background: white; color: black; display: block !important; }
        }
    </style>
</head>
<body class="selection:bg-orange-500/30">

    <div class="bg-black text-orange-500 py-2 overflow-hidden border-b border-orange-500/20 no-print">
        <div class="animate-marquee gap-10 font-black text-[10px] uppercase tracking-[0.2em]">
            <span>‚ö° DISTRIBUIDORA EL URU - VIEDMA Y PATAGONES ‚ö°</span>
            <span>üì¶ PEDIDOS HASTA 12:30HS ENTREGA HOY üì¶</span>
            <span>üî• PRECIOS MAYORISTAS ACTUALIZADOS 2026 üî•</span>
            <span>‚ö° DISTRIBUIDORA EL URU - VIEDMA Y PATAGONES ‚ö°</span>
        </div>
    </div>

    <nav class="bg-black/80 backdrop-blur-2xl sticky top-0 z-50 p-4 border-b border-white/5 no-print">
        <div class="max-w-7xl mx-auto flex justify-between items-center">
            <div class="flex items-center gap-4" onclick="abrirLogistica()">
                <img src="https://i.ibb.co/yB7ffL4T/unnamed.jpg" class="w-12 h-12 rounded-2xl border border-orange-600 shadow-lg">
                <div>
                    <h1 class="text-xl font-black italic text-white uppercase leading-none">EL <span class="text-orange-600">URU</span></h1>
                    <p id="status-text" class="text-[8px] text-gray-500 font-bold uppercase tracking-widest mt-1">Cargando...</p>
                </div>
            </div>
            <div class="flex items-center gap-3">
                <button onclick="toggleTheme()" class="w-10 h-10 rounded-xl bg-white/5 text-orange-500 flex items-center justify-center border border-white/10">
                    <i id="theme-icon" class="fas fa-moon"></i>
                </button>
                <button onclick="document.getElementById('cart-modal').style.display='flex'" class="bg-orange-600 text-white px-5 py-3 rounded-2xl font-black flex items-center gap-3 text-xs shadow-lg active:scale-95 transition-all">
                    <i class="fas fa-shopping-basket text-base"></i>
                    <span id="count-badge" class="bg-white text-orange-600 px-2 py-0.5 rounded-lg">0</span>
                </button>
            </div>
        </div>
    </nav>

    <div class="p-6 max-w-7xl mx-auto space-y-6 no-print">
        <div class="relative max-w-3xl mx-auto">
            <input type="text" id="search" oninput="renderCatalogo()" placeholder="Busca productos o marcas..." class="w-full bg-white/5 border border-white/10 py-6 pl-14 pr-6 rounded-[2rem] text-white focus:outline-none focus:border-orange-500 transition-all">
            <i class="fas fa-search absolute left-6 top-1/2 -translate-y-1/2 text-gray-500"></i>
        </div>
        
        <div class="flex justify-center gap-4 border-y border-white/5 py-4">
            <button onclick="toggleSoloFavs()" id="btn-favs" class="text-[10px] font-black uppercase text-gray-500 hover:text-red-500 flex items-center gap-2">
                <i class="fas fa-heart"></i> Favoritos
            </button>
            <div class="w-[1px] bg-white/10"></div>
            <button onclick="abrirHistorial()" class="text-[10px] font-black uppercase text-gray-500 hover:text-blue-500 flex items-center gap-2">
                <i class="fas fa-history"></i> Historial
            </button>
        </div>

        <div id="categorias" class="flex gap-3 overflow-x-auto pb-4 no-scrollbar"></div>
    </div>

    <main id="catalogo" class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-6 p-6 max-w-7xl mx-auto min-h-screen no-print"></main>

    <footer class="pt-20 pb-12 px-8 mt-16 bg-[var(--footer-bg)] border-t border-[var(--border-color)] no-print">
        <div class="max-w-7xl mx-auto grid grid-cols-1 md:grid-cols-3 gap-12">
            <div class="space-y-4">
                <div class="flex items-center gap-4">
                    <img src="https://i.ibb.co/yB7ffL4T/unnamed.jpg" class="w-14 h-14 rounded-xl border-2 border-orange-600">
                    <h2 class="text-2xl font-black italic text-orange-500 uppercase">El Uru</h2>
                </div>
                <p class="text-xs text-[var(--text-muted)] font-medium leading-relaxed">Distribuidora mayorista l√≠der en Viedma y Patagones. Calidad premium garantizada.</p>
            </div>
            <div class="space-y-4 font-bold text-sm text-[var(--text-muted)]">
                <h3 class="text-white uppercase text-xs tracking-widest border-l-4 border-orange-600 pl-3">Contacto</h3>
                <p><i class="fab fa-whatsapp text-green-500 mr-2"></i> +54 9 2920 248292</p>
                <p><i class="fas fa-clock text-orange-500 mr-2"></i> Cierre de pedidos: 12:30hs</p>
            </div>
            <div class="space-y-4">
                <h3 class="text-white uppercase text-xs tracking-widest border-l-4 border-orange-600 pl-3">Horarios</h3>
                <p class="text-sm text-[var(--text-muted)] font-bold">Martes a S√°bados</p>
                <p class="text-xs text-[var(--text-muted)]">Atenci√≥n continua y repartos diarios.</p>
            </div>
        </div>
        <div class="mt-12 pt-8 border-t border-white/5 text-center">
            <p class="text-[9px] font-black text-gray-600 uppercase tracking-widest cursor-pointer" onclick="abrirLogistica()">¬© 2026 DISTRIBUIDORA EL URU - ACCESO ADMINISTRATIVO</p>
        </div>
    </footer>

    <div id="cart-modal" style="display:none;" class="fixed inset-0 bg-black/90 backdrop-blur-md z-[100] flex justify-end">
        <div class="bg-[var(--bg-main)] w-full max-w-md h-full flex flex-col border-l border-white/10">
            <div class="p-6 border-b border-white/10 flex justify-between items-center">
                <h2 class="text-xl font-black uppercase italic text-orange-600">Mi Pedido</h2>
                <button onclick="this.closest('#cart-modal').style.display='none'" class="text-3xl text-gray-500">&times;</button>
            </div>
            <div id="cart-items" class="flex-1 overflow-y-auto p-6 space-y-4"></div>
            <div class="p-6 bg-white/5 border-t border-white/10 space-y-4">
                <input type="text" id="user-name" placeholder="Nombre del Comercio" class="w-full p-4 rounded-xl bg-black border border-white/10 text-white font-bold">
                <div class="flex justify-between items-center">
                    <span class="text-gray-500 uppercase text-[10px] font-black">Total:</span>
                    <span id="cart-total" class="text-2xl font-black text-orange-500">$0</span>
                </div>
                <button onclick="enviarPedido()" class="w-full bg-green-600 text-white py-5 rounded-2xl font-black uppercase tracking-widest">Enviar Pedido</button>
            </div>
        </div>
    </div>

    <div id="modal-logistica" class="fixed inset-0 bg-black z-[200] hidden overflow-y-auto p-6">
        <div class="max-w-4xl mx-auto">
            <div class="flex justify-between items-center mb-8 no-print">
                <h2 class="text-2xl font-black text-orange-500 uppercase italic">Hoja de Carga</h2>
                <div class="flex gap-4">
                    <button onclick="window.print()" class="bg-white text-black px-6 py-2 rounded-xl font-black uppercase text-xs">Imprimir</button>
                    <button onclick="cerrarLogistica()" class="text-white text-3xl">&times;</button>
                </div>
            </div>
            <div id="cont-tabla-carga" class="bg-[#111] rounded-3xl overflow-hidden border border-white/10"></div>
        </div>
    </div>

    <script>
        const TSV_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQEemzCvTezcjzZhIUIRIayZ7U81xgssl9G1Vr6Odx7dHGHOARY0iJ-VOL43E17qLVkiIRb0LTurcZU/pub?output=tsv';
        let data = [], cart = {}, favoritos = JSON.parse(localStorage.getItem('uru_favs')) || [];
        let activeCat = 'TODOS', soloFavs = false;

        async function init() {
            try {
                const res = await fetch(TSV_URL + '?t=' + Date.now());
                const text = await res.text();
                const rows = text.split(/\r?\n/).slice(1);
                data = rows.map((r, i) => {
                    const c = r.split('\t');
                    return { id: i, nom: c[0], pre: parseFloat(c[1]) || 0, cat: (c[2] || 'VARIOS').toUpperCase(), img: c[3] };
                }).filter(p => p.nom);
                
                renderCategories();
                renderCatalogo();
                checkStatus();
                applyTheme();
            } catch (e) { console.error(e); }
        }

        function renderCategories() {
            const cats = ['TODOS', ...new Set(data.map(p => p.cat))];
            document.getElementById('categorias').innerHTML = cats.map(c => `
                <button onclick="setCat('${c}')" class="px-6 py-3 rounded-full border border-white/10 text-[10px] font-black uppercase shrink-0 ${activeCat === c ? 'bg-orange-600 text-white' : 'bg-white/5 text-gray-500'}">${c}</button>
            `).join('');
        }

        function renderCatalogo() {
            const query = document.getElementById('search').value.toLowerCase();
            let filtered = data.filter(p => (activeCat === 'TODOS' || p.cat === activeCat) && p.nom.toLowerCase().includes(query));
            if(soloFavs) filtered = filtered.filter(p => favoritos.includes(p.id));

            document.getElementById('catalogo').innerHTML = filtered.map(p => {
                const q = cart[p.id] || 0;
                return `
                    <div class="product-card p-4 rounded-[2rem] flex flex-col relative ${p.pre === 0 ? 'opacity-50 grayscale' : ''}">
                        <button onclick="toggleFav(${p.id})" class="absolute top-4 left-4 z-10 ${favoritos.includes(p.id) ? 'text-red-500' : 'text-gray-600'}">
                            <i class="fas fa-heart"></i>
                        </button>
                        <div class="h-32 flex items-center justify-center mb-4">
                            <img src="${p.img}" class="max-h-full object-contain" onerror="this.src='https://i.ibb.co/yB7ffL4T/unnamed.jpg'">
                        </div>
                        <h3 class="text-[10px] font-black uppercase h-8 leading-tight mb-2">${p.nom}</h3>
                        <p class="text-orange-500 font-black text-xl mb-4">${p.pre > 0 ? '$' + p.pre.toLocaleString() : 'CONSULTAR'}</p>
                        ${p.pre > 0 ? `
                            <div class="flex items-center bg-white/5 rounded-xl p-1 border border-white/10">
                                <button onclick="add(${p.id},-1)" class="w-8 h-8 text-xl font-bold">-</button>
                                <span class="flex-1 text-center font-black text-sm">${q}</span>
                                <button onclick="add(${p.id},1)" class="w-8 h-8 text-xl font-bold text-orange-500">+</button>
                            </div>
                        ` : `<button disabled class="w-full py-3 bg-gray-800 rounded-xl text-[9px] font-black uppercase">Agotado</button>`}
                    </div>
                `;
            }).join('');
        }

        function add(id, n) {
            cart[id] = Math.max(0, (cart[id] || 0) + n);
            if(cart[id] === 0) delete cart[id];
            updateUI();
            renderCatalogo();
        }

        function updateUI() {
            let total = 0, count = 0, html = '';
            Object.entries(cart).forEach(([id, q]) => {
                const p = data[id];
                total += p.pre * q; count += q;
                html += `
                    <div class="flex justify-between items-center p-4 bg-white/5 rounded-2xl border border-white/10">
                        <div class="text-[10px] font-black uppercase">${p.nom} <br> <span class="text-orange-500">$${p.pre} x ${q}</span></div>
                        <div class="font-black text-white">$${(p.pre * q).toLocaleString()}</div>
                    </div>
                `;
            });
            document.getElementById('cart-items').innerHTML = html || '<p class="text-center py-20 opacity-20 font-black uppercase">Carrito Vac√≠o</p>';
            document.getElementById('cart-total').innerText = '$' + total.toLocaleString();
            document.getElementById('count-badge').innerText = count;
        }

        function checkStatus() {
            const now = new Date();
            const hour = now.getHours();
            const min = now.getMinutes();
            const isClosed = (hour > 12 || (hour === 12 && min >= 30));
            const status = document.getElementById('status-text');
            if(isClosed) {
                status.innerText = "‚óè ENTREGAS MA√ëANA (CERRADO)";
                status.classList.replace('text-gray-500', 'text-red-500');
            } else {
                status.innerText = "‚óè ABIERTO - REPARTO HOY";
                status.classList.replace('text-gray-500', 'text-green-500');
            }
        }

        function abrirLogistica() {
            const pin = prompt("PIN Administrativo:");
            if(pin === "URU2026") {
                let table = `<table class="w-full text-left border-collapse">
                    <thead class="bg-orange-600 text-white uppercase text-[10px]"><tr><th class="p-4">Producto</th><th class="p-4 text-center">Cant</th><th class="p-4">Check</th></tr></thead><tbody>`;
                Object.entries(cart).forEach(([id, q]) => {
                    table += `<tr class="border-b border-white/5" id="row-${id}">
                        <td class="p-4 text-xs font-bold text-white">${data[id].nom}</td>
                        <td class="p-4 text-center text-orange-500 font-black text-xl">${q}</td>
                        <td class="p-4 text-center"><input type="checkbox" onchange="document.getElementById('row-${id}').classList.toggle('fila-check')" class="w-6 h-6"></td>
                    </tr>`;
                });
                table += `</tbody></table>`;
                document.getElementById('cont-tabla-carga').innerHTML = table;
                document.getElementById('modal-logistica').classList.remove('hidden');
            }
        }

        function enviarPedido() {
            const name = document.getElementById('user-name').value;
            if(!name) return Swal.fire('Error', 'Ingresa el nombre del comercio', 'warning');
            let msg = `*PEDIDO: ${name.toUpperCase()}*%0A%0A`;
            Object.entries(cart).forEach(([id, q]) => msg += `üîπ *${q}x* ${data[id].nom}%0A`);
            msg += `%0Aüí∞ *TOTAL: ${document.getElementById('cart-total').innerText}*`;
            window.open(`https://wa.me/5492920248292?text=${msg}`);
        }

        // Helpers
        function setCat(c) { activeCat = c; renderCategories(); renderCatalogo(); }
        function toggleFav(id) {
            if(favoritos.includes(id)) favoritos = favoritos.filter(f => f !== id);
            else favoritos.push(id);
            localStorage.setItem('uru_favs', JSON.stringify(favoritos));
            renderCatalogo();
        }
        function toggleSoloFavs() {
            soloFavs = !soloFavs;
            document.getElementById('btn-favs').classList.toggle('text-red-500');
            renderCatalogo();
        }
        function toggleTheme() {
            document.body.classList.toggle('light-mode');
            localStorage.setItem('uru_theme', document.body.classList.contains('light-mode') ? 'light' : 'dark');
            applyTheme();
        }
        function applyTheme() {
            const isLight = localStorage.getItem('uru_theme') === 'light';
            document.getElementById('theme-icon').className = isLight ? 'fas fa-sun' : 'fas fa-moon';
            if(isLight) document.body.classList.add('light-mode');
        }
        function cerrarLogistica() { document.getElementById('modal-logistica').classList.add('hidden'); }

        window.onload = init;
    </script>
</body>
</html>
